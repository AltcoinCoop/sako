<!DOCTYPE html>

<script type="text/javascript">
	var ws = new WebSocket("ws://" + window.location.host + "/socket");

	ws.onmessage = function(evt) {
		var msg = JSON.parse(evt.data);

		switch (Object.keys(msg)[0].split("_")[0]) {
		case "price":
			document.getElementById("price").innerHTML = "$"+msg.price_Price;
			document.getElementById("change").innerHTML = msg.price_Change+"%";

			break;
		case "graph":
			graphData.labels = msg.graph_Date;
			graphData.datasets[0].data = msg.graph_Price;
			window.graph.update();

			break;
		}
	}

	var graphData = {
		datasets: [{
			label: "Price",
			data: {{.Graph.Price}},
			borderColor: "rgba(255, 206, 86, 1)",
			backgroundColor: "rgba(255, 206, 86, 0.4)",
			pointBackgroundColor: "#FFCE56",
			pointRadius: 0,
			pointBorderWidth: 0,
		}],
		labels: {{.Graph.Date}},
	};

	window.onload = function() {
		var ctx = document.getElementById("graph").getContext("2d");

		window.graph = new Chart(ctx, {
			type: "line",
			data: graphData,
			options: {
				maintainAspectRatio: false,
				tooltips: false,
				responsive: true,
				legend: {
					display: false
				},
				scales: {
					xAxes: [{
						display: false,
						ticks: {
							display: false,
						},
						gridLines: {
							display: false,
						},
					}],
					yAxes: [{
						display: false,
						ticks: {
							display: false,
						},
						gridLines: {
							display: false,
						},
					}],
				},
			},
		});
	}
</script>

<html>
	<head>
		<title>{{.Title}}</title>

		<link rel="stylesheet" href="/assets/style.css">

		<link rel="stylesheet" href="/assets/bundle/css/font-awesome.min.css">
		<script src="/assets/bundle/js/moment.min.js"></script>
		<script src="/assets/bundle/js/Chart.min.js"></script>
	</head>

	<body>
		<div id="sidebar">
			<div id="card-container">
				<div id="card">
					<div id="front">
						<div id="monero">
							<img src="/assets/images/monero.svg"></img>
							<span>MONERO</span>
						</div>

						</br>

						<div class="balance-label">Your balance</div>
						<div class="balance">{{.Sidebar.Balance}}</div>

						</br>

						<div class="balance-label">Unlocked Balance</div>
						<div class="balance">{{.Sidebar.UnBalance}}</div>
					</div>

					<div id="back">
						<img id="qr" src="/assets/images/qr/{{.Sidebar.Address}}.png"></img>
					</div>
				</div>
			</div>

			<ul>
				<li><a href="#"><i class="fa fa-area-chart"></i>Info</a></li>
				<li><a href="#"><i class="fa fa-send"></i>Send</a></li>
				<li><a href="#"><i class="fa fa-send fa-flip-horizontal"></i>Receive</a></li>
				<li><a href="#"><i class="fa fa-address-book"></i>Address book</a></li>
				<li><a href="#"><i class="fa fa-history"></i>History</a></li>
				<li><a href="#"><i class="fa fa-ellipsis-h"></i>Advanced</a></li>
				<li><a href="#"><i class="fa fa-wrench"></i>Settings</a></li>
				<li><a href="#"><i class="fa fa-question"></i>About</a></li>
			</ul>
		</div>

		<div id="content">
			<div id="price-container">
				<small>1 XMR =</small>
				<h1 id="price">${{.Price}}</h1>
				<h2 id="change">{{.Change}}%</h2>
			</div>

			<div class="background">
				<canvas id="graph"></canvas>
				<div id="gradient"></div>
			</div>
		</div>
	</body>
</html>
