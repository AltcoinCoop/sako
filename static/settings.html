<!DOCTYPE html>

<html>
	<head>
		<title>{{.Title}}</title>

		<link rel="stylesheet" href="/static/css/base.css">
		<link rel="stylesheet" href="/static/css/sidebar.css">
		<link rel="stylesheet" href="/static/css/content.css">
		<link rel="stylesheet" href="/static/css/info.css">

		<link rel="stylesheet" href="/static/vendor/css/font-awesome.min.css">
		<script src="/static/vendor/js/moment.min.js"></script>
		<script src="/static/vendor/js/Chart.min.js"></script>
	</head>

	<body>
		<div id="sidebar">
			<div id="card-container">
				<div id="card">
					<div id="front">
						<div id="monero">
							<img src="/static/images/monero.svg"></img>
							<span>MONERO</span>
						</div>

						</br>

						<div class="balance-label">Your balance</div>
						<div class="balance">{{.Sidebar.Balance}}</div>

						</br>

						<div class="balance-label">Unlocked Balance</div>
						<div class="balance">{{.Sidebar.UnBalance}}</div>
					</div>

					<div id="back">
						<img id="qr" src="/static/images/qr/{{.Sidebar.Address}}.png"></img>
					</div>
				</div>
			</div>

			<ul>
				<li><a href="/info"><i class="fa fa-area-chart"></i>Info</a></li>
				<li><a href="/send"><i class="fa fa-send"></i>Send</a></li>
				<li><a href="/receive"><i class="fa fa-send fa-flip-horizontal"></i>Receive</a></li>
				<li><a href="/address-book"><i class="fa fa-address-book"></i>Address book</a></li>
				<li><a href="/history"><i class="fa fa-history"></i>History</a></li>
				<li><a href="/advances"><i class="fa fa-ellipsis-h"></i>Advanced</a></li>
				<li class="active"><a href="/settings"><i class="fa fa-wrench"></i>Settings</a></li>
				<li><a href="/about"><i class="fa fa-question"></i>About</a></li>
			</ul>
		</div>

		<div id="content">
			<div id="background">
				<canvas id="graph"></canvas>
				<div id="gradient"></div>
			</div>


		</div>
	</body>
</html>

<script type="text/javascript">
	var ws = new WebSocket("ws://" + window.location.host + "/socket");

	ws.onmessage = function(evt) {
		var msg = JSON.parse(evt.data);

		document.title = document.title.replace(/[0-9.]*/,
			msg.coincapCurrent);

		graphData.labels = msg.coincapDate;
		graphData.datasets[0].data = msg.coincapPrice;
		window.graph.update();
	}

	var graphData = {
		datasets: [{
			label: "Price",
			data: {{.Coincap.Price}},
			borderColor: "rgba(255, 206, 86, 1)",
			backgroundColor: "rgba(255, 255, 255, 1)",
			pointBackgroundColor: "#FFCE56",
			pointRadius: 0,
			pointBorderWidth: 0,
		}],
		labels: {{.Coincap.Date}},
	};

	window.onload = function() {
		colorizeCurrent();

		var ctx = document.getElementById("graph").getContext("2d");
		ctx.globalCompositeOperation = "destination-over";

		window.graph = new Chart(ctx, {
			type: "line",
			data: graphData,
			options: {
				maintainAspectRatio: false,
				tooltips: false,
				responsive: true,
				legend: {
					display: false
				},
				scales: {
					xAxes: [{
						display: false,
						type: 'time',
						ticks: {
							display: true,
						},
						gridLines: {
							display: false,
						},
					}],
					yAxes: [{
						display: false,
						ticks: {
							display: false,
						},
						gridLines: {
							display: false,
						},
					}],
				},
			},
		});
	}

	function colorizeCurrent() {
		if (document.getElementById("change").textContent.charAt(0) == "+") {
			document.getElementById("change").className = "text-green";
		} else {
			document.getElementById("change").className = "text-red";
		}
	}
</script>
